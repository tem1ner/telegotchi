<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ü¶á –ú—ã—à—å–∫–∞-–ª–µ—Ç—É—á–∫–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* –°–ë–†–ê–°–´–í–ê–ï–ú –í–°–ï –û–¢–°–¢–£–ü–´ –ò –°–ö–†–û–õ–õ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-overflow-scrolling: touch;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden; /* –û–¢–ö–õ–Æ–ß–ê–ï–ú –ü–†–û–ö–†–£–¢–ö–£ */
            position: fixed; /* –§–ò–ö–°–ò–†–£–ï–ú */
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0c0c2e;
            color: white;
        }
        
        /* –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† */
        .app-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* –®–ê–ü–ö–ê */
        .header {
            background: linear-gradient(90deg, #8b00ff 0%, #ff0066 100%);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
            border-bottom: 2px solid #ff0066;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .user-avatar {
            font-size: 32px;
            animation: float 3s ease-in-out infinite;
        }
        
        .user-name {
            font-size: 18px;
            font-weight: bold;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }
        
        .stats-bar {
            display: flex;
            gap: 15px;
        }
        
        .stat {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 16px;
            font-weight: bold;
            color: #ffcc00;
        }
        
        .stat i {
            color: #ff0066;
            font-size: 18px;
        }
        
        /* –ö–û–ú–ù–ê–¢–ê –ë–ê–®–ù–ò - –§–ò–ö–°–ò–†–û–í–ê–ù–ù–ê–Ø –ö–ê–†–¢–ò–ù–ö–ê */
        .tower-room {
            flex: 1;
            background: linear-gradient(180deg, #1a1a3e 0%, #0c0c2e 100%);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 0; /* –í–∞–∂–Ω–æ –¥–ª—è flex */
        }
        
        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–æ–º–Ω–∞—Ç—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —Ä–∞–∑–º–µ—Ä–æ–≤ */
        .room-container {
            width: 375px;
            height: 300px;
            max-width: 100%;
            max-height: 60vh;
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 3px solid rgba(255, 0, 102, 0.3);
        }
        
        /* –§–æ–Ω –∫–æ–º–Ω–∞—Ç—ã (–±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ Photoshop) */
        .room-background {
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(rgba(12, 12, 46, 0.8), rgba(12, 12, 46, 0.9)),
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="375" height="300"><defs><pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse"><path d="M 40 0 L 0 0 0 40" fill="none" stroke="%238b00ff" stroke-width="1" opacity="0.3"/></pattern></defs><rect width="100%" height="100%" fill="%231a1a3e"/><rect width="100%" height="100%" fill="url(%23grid)"/><circle cx="50%" cy="40%" r="80" fill="%238b00ff" opacity="0.1"/></svg>');
            background-size: cover;
            background-position: center;
            position: absolute;
            top: 0;
            left: 0;
        }
        
        /* –û–∫–Ω–æ –≤ –±–∞—à–Ω–µ */
        .tower-window {
            position: absolute;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 120px;
            background: rgba(135, 206, 235, 0.2);
            border: 8px solid #8B4513;
            border-radius: 15px 15px 0 0;
            overflow: hidden;
            z-index: 2;
        }
        
        .window-content {
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #1e3c72, #2a5298);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        /* –í–∏—Å–µ–ª–∫–∞ –¥–ª—è –º—ã—à–∫–∏ */
        .bat-perch {
            position: absolute;
            top: 180px;
            left: 60px;
            width: 80px;
            height: 10px;
            background: #8B4513;
            border-radius: 5px;
            z-index: 3;
        }
        
        /* –ö–æ—Ä–º—É—à–∫–∞ */
        .bat-feeder {
            position: absolute;
            top: 180px;
            right: 60px;
            width: 60px;
            height: 40px;
            background: #654321;
            border-radius: 10px;
            border: 2px solid #8B4513;
            z-index: 3;
        }
        
        /* –õ–µ—Ç—É—á–∞—è –º—ã—à–∫–∞ */
        .bat-character {
            position: absolute;
            top: 160px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 80px;
            z-index: 4;
            animation: batHover 2s ease-in-out infinite;
        }
        
        .bat-body {
            width: 60px;
            height: 40px;
            background: #222;
            border-radius: 50%;
            position: absolute;
            top: 20px;
            left: 10px;
            box-shadow: 0 0 10px rgba(255, 0, 102, 0.3);
        }
        
        .bat-wing {
            position: absolute;
            width: 80px;
            height: 60px;
            background: #111;
            border-radius: 50%;
            top: 10px;
        }
        
        .wing-left {
            left: -30px;
            transform: rotate(-20deg);
            animation: flapLeft 1.5s infinite alternate;
        }
        
        .wing-right {
            right: -30px;
            transform: rotate(20deg);
            animation: flapRight 1.5s infinite alternate;
        }
        
        .bat-face {
            position: absolute;
            top: 30px;
            left: 20px;
            width: 40px;
            height: 30px;
        }
        
        .bat-eye {
            position: absolute;
            width: 12px;
            height: 18px;
            background: #ff0000;
            border-radius: 50%;
            top: 5px;
        }
        
        .eye-left {
            left: 8px;
        }
        
        .eye-right {
            right: 8px;
        }
        
        .bat-mouth {
            position: absolute;
            width: 20px;
            height: 10px;
            background: #ff3366;
            border-radius: 0 0 10px 10px;
            bottom: 0;
            left: 10px;
        }
        
        /* –°—Ç–∞—Ç—É—Å –±–∞—Ä—ã */
        .status-bars {
            padding: 15px 20px;
            background: rgba(26, 26, 62, 0.8);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            flex-shrink: 0;
        }
        
        .status-bar {
            margin: 8px 0;
        }
        
        .status-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
            font-size: 14px;
        }
        
        .bar-container {
            width: 100%;
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            overflow: hidden;
        }
        
        .bar-fill {
            height: 100%;
            border-radius: 6px;
            transition: width 0.5s ease;
        }
        
        .hunger { 
            background: linear-gradient(90deg, #ff416c, #ff4b2b);
            width: 60%;
        }
        
        .happiness { 
            background: linear-gradient(90deg, #00b09b, #96c93d);
            width: 80%;
        }
        
        .energy { 
            background: linear-gradient(90deg, #f7971e, #ffd200);
            width: 70%;
        }
        
        /* –ö–ù–û–ü–ö–ò –î–ï–ô–°–¢–í–ò–ô */
        .action-buttons {
            padding: 15px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            background: rgba(12, 12, 46, 0.9);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            flex-shrink: 0;
        }
        
        .action-btn {
            background: linear-gradient(135deg, #8b00ff, #ff0066);
            border: none;
            border-radius: 15px;
            padding: 15px 5px;
            color: white;
            font-size: 14px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 0, 102, 0.4);
        }
        
        .action-btn i {
            font-size: 20px;
        }
        
        /* –ù–ò–ñ–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ –ù–ê–í–ò–ì–ê–¶–ò–ò */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(26, 26, 62, 0.95);
            border-top: 2px solid #8b00ff;
            backdrop-filter: blur(20px);
            z-index: 1000;
            padding: 10px 0;
            display: flex;
            justify-content: space-around;
            flex-shrink: 0;
        }
        
        .nav-btn {
            background: none;
            border: none;
            color: #888;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
            min-width: 60px;
            font-size: 11px;
        }
        
        .nav-btn.active {
            background: rgba(139, 0, 255, 0.2);
            color: #ffcc00;
            transform: translateY(-5px);
        }
        
        .nav-btn i {
            font-size: 20px;
        }
        
        /* –ó–ê–ü–†–ï–¢ –ü–†–û–ö–†–£–¢–ö–ò –ò –í–´–î–ï–õ–ï–ù–ò–Ø */
        .no-scroll {
            overflow: hidden !important;
            position: fixed !important;
            width: 100% !important;
            height: 100% !important;
        }
        
        .no-select {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
        
        /* –ê–ù–ò–ú–ê–¶–ò–ò */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes batHover {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-10px); }
        }
        
        @keyframes flapLeft {
            0% { transform: rotate(-20deg) scaleY(1); }
            100% { transform: rotate(-10deg) scaleY(1.1); }
        }
        
        @keyframes flapRight {
            0% { transform: rotate(20deg) scaleY(1); }
            100% { transform: rotate(10deg) scaleY(1.1); }
        }
        
        /* –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê (—Å–∫—Ä—ã—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            overflow-y: auto; /* –¢–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –º–æ–¥–∞–ª–∫–∏ –º–æ–∂–Ω–æ —Å–∫—Ä–æ–ª–ª–∏—Ç—å */
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1a1a3e, #0c0c2e);
            margin: 20px auto;
            padding: 20px;
            border-radius: 20px;
            max-width: 400px;
            max-height: 80vh;
            border: 2px solid #8b00ff;
            position: relative;
        }
        
        .close-btn {
            background: #ff0066;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
            width: 100%;
        }
        
        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-width: 400px) {
            .room-container {
                width: 95%;
                height: 280px;
            }
            
            .action-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .nav-btn {
                font-size: 10px;
                padding: 5px 8px;
                min-width: 50px;
            }
        }
        
        @media (max-height: 700px) {
            .room-container {
                height: 250px;
            }
            
            .status-bars {
                padding: 10px 15px;
            }
        }
    </style>
</head>
<body class="no-scroll no-select">
    <div class="app-container">
        <!-- –®–ê–ü–ö–ê -->
        <header class="header">
            <div class="user-info">
                <div class="user-avatar">ü¶á</div>
                <div class="user-name" id="userName">–ú—ã—à—å–∫–∞-–ª–µ—Ç—É—á–∫–∞</div>
            </div>
            <div class="stats-bar">
                <div class="stat">
                    <i class="fas fa-moon"></i>
                    <span id="coins">100</span>
                </div>
                <div class="stat">
                    <i class="fas fa-star"></i>
                    <span id="level">1</span>
                </div>
                <div class="stat">
                    <i class="fas fa-heart"></i>
                    <span id="health">100</span>
                </div>
            </div>
        </header>
        
        <!-- –ö–û–ú–ù–ê–¢–ê –ë–ê–®–ù–ò (–ù–ï –ü–†–û–ö–†–£–ß–ò–í–ê–ï–¢–°–Ø) -->
        <main class="tower-room">
            <div class="room-container">
                <!-- –§–æ–Ω –∫–æ–º–Ω–∞—Ç—ã -->
                <div class="room-background"></div>
                
                <!-- –û–∫–Ω–æ –±–∞—à–Ω–∏ -->
                <div class="tower-window">
                    <div class="window-content" id="windowContent">
                        üåô –ù–æ—á—å
                    </div>
                </div>
                
                <!-- –í–∏—Å–µ–ª–∫–∞ -->
                <div class="bat-perch"></div>
                
                <!-- –ö–æ—Ä–º—É—à–∫–∞ -->
                <div class="bat-feeder"></div>
                
                <!-- –õ–µ—Ç—É—á–∞—è –º—ã—à–∫–∞ -->
                <div class="bat-character">
                    <div class="bat-body"></div>
                    <div class="bat-wing wing-left"></div>
                    <div class="bat-wing wing-right"></div>
                    <div class="bat-face">
                        <div class="bat-eye eye-left"></div>
                        <div class="bat-eye eye-right"></div>
                        <div class="bat-mouth"></div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- –°–¢–ê–¢–£–° –ë–ê–†–´ -->
        <div class="status-bars">
            <div class="status-bar">
                <div class="status-label">
                    <span>ü©∏ –ì–æ–ª–æ–¥</span>
                    <span id="hungerValue">60%</span>
                </div>
                <div class="bar-container">
                    <div class="bar-fill hunger"></div>
                </div>
            </div>
            <div class="status-bar">
                <div class="status-label">
                    <span>üòä –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</span>
                    <span id="happinessValue">80%</span>
                </div>
                <div class="bar-container">
                    <div class="bar-fill happiness"></div>
                </div>
            </div>
            <div class="status-bar">
                <div class="status-label">
                    <span>‚ö° –≠–Ω–µ—Ä–≥–∏—è</span>
                    <span id="energyValue">70%</span>
                </div>
                <div class="bar-container">
                    <div class="bar-fill energy"></div>
                </div>
            </div>
        </div>
        
        <!-- –ö–ù–û–ü–ö–ò –î–ï–ô–°–¢–í–ò–ô -->
        <div class="action-buttons">
            <button class="action-btn" onclick="performAction('feed')">
                <i class="fas fa-wine-bottle"></i>
                <span>–ü–æ–∫–æ—Ä–º–∏—Ç—å</span>
            </button>
            <button class="action-btn" onclick="performAction('play')">
                <i class="fas fa-ghost"></i>
                <span>–ü–æ–∏–≥—Ä–∞—Ç—å</span>
            </button>
            <button class="action-btn" onclick="performAction('clean')">
                <i class="fas fa-bath"></i>
                <span>–ü–æ–º—ã—Ç—å</span>
            </button>
            <button class="action-btn" onclick="performAction('sleep')">
                <i class="fas fa-bed"></i>
                <span>–£–ª–æ–∂–∏—Ç—å</span>
            </button>
        </div>
        
        <!-- –ù–ò–ñ–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ –ù–ê–í–ò–ì–ê–¶–ò–ò -->
        <nav class="bottom-nav">
            <button class="nav-btn" onclick="openTab('home')">
                <i class="fas fa-home"></i>
                <span>–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            <button class="nav-btn" onclick="openTab('shop')">
                <i class="fas fa-store"></i>
                <span>–ú–∞–≥–∞–∑–∏–Ω</span>
            </button>
            <button class="nav-btn" onclick="openTab('friends')">
                <i class="fas fa-users"></i>
                <span>–î—Ä—É–∑—å—è</span>
            </button>
            <button class="nav-btn" onclick="openTab('tasks')">
                <i class="fas fa-tasks"></i>
                <span>–ó–∞–¥–∞—á–∏</span>
            </button>
            <button class="nav-btn" onclick="openTab('settings')">
                <i class="fas fa-cog"></i>
                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </button>
        </nav>
        
        <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ú–ê–ì–ê–ó–ò–ù–ê -->
        <div id="shopModal" class="modal">
            <div class="modal-content">
                <h3>üõçÔ∏è –í–∞–º–ø–∏—Ä-–º–∞–≥–∞–∑–∏–Ω</h3>
                <div class="shop-items">
                    <div class="shop-item">
                        <i class="fas fa-wine-bottle"></i>
                        <span>–§–ª–∞–∫–æ–Ω –∫—Ä–æ–≤–∏</span>
                        <button class="buy-btn" onclick="buyItem('blood')">25 ü™ô</button>
                    </div>
                    <div class="shop-item">
                        <i class="fas fa-crown"></i>
                        <span>–ö–æ—Ä–æ–Ω–∞ –Ω–æ—á–∏</span>
                        <button class="buy-btn" onclick="buyItem('crown')">100 ü™ô</button>
                    </div>
                    <div class="shop-item">
                        <i class="fas fa-vest"></i>
                        <span>–ü–ª–∞—â</span>
                        <button class="buy-btn" onclick="buyItem('cloak')">75 ü™ô</button>
                    </div>
                </div>
                <button onclick="closeModal('shopModal')" class="close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
        
        <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–†–£–ó–ï–ô -->
        <div id="friendsModal" class="modal">
            <div class="modal-content">
                <h3>üë• –î—Ä—É–∑—å—è</h3>
                <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –≤–∞—à–∏ –¥—Ä—É–∑—å—è</p>
                <button onclick="closeModal('friendsModal')" class="close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
        
        <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ó–ê–î–ê–ß -->
        <div id="tasksModal" class="modal">
            <div class="modal-content">
                <h3>üìã –ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏</h3>
                <div class="tasks-list">
                    <div class="task">üéÆ –ü–æ–∏–≥—Ä–∞—Ç—å —Å –º—ã—à–∫–æ–π</div>
                    <div class="task">ü©∏ –ü–æ–∫–æ—Ä–º–∏—Ç—å 3 —Ä–∞–∑–∞</div>
                    <div class="task">‚ú® –ü–æ–º—ã—Ç—å –∫—Ä—ã–ª—å—è</div>
                </div>
                <button onclick="closeModal('tasksModal')" class="close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
        
        <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ù–ê–°–¢–†–û–ï–ö -->
        <div id="settingsModal" class="modal">
            <div class="modal-content">
                <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                <div class="settings-options">
                    <label class="switch">
                        <input type="checkbox" id="soundToggle" checked>
                        <span class="slider"></span>
                        <span>üîä –ó–≤—É–∫</span>
                    </label>
                    <label class="switch">
                        <input type="checkbox" id="notificationsToggle" checked>
                        <span class="slider"></span>
                        <span>üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                    </label>
                </div>
                <button onclick="closeModal('settingsModal')" class="close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
    
    <script>
        // ========== –ó–ê–ü–†–ï–¢ –ü–†–û–ö–†–£–¢–ö–ò ==========
        document.addEventListener('DOMContentLoaded', function() {
            // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∫—Ä–æ–ª–ª–∞ –Ω–∞ touch —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
            document.body.addEventListener('touchmove', function(e) {
                // –†–∞–∑—Ä–µ—à–∞–µ–º —Å–∫—Ä–æ–ª–ª —Ç–æ–ª—å–∫–æ –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö
                if (!e.target.closest('.modal-content')) {
                    e.preventDefault();
                }
            }, { passive: false });
            
            // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∫—Ä–æ–ª–ª–∞ –∫–æ–ª–µ—Å–∏–∫–æ–º
            window.addEventListener('wheel', function(e) {
                if (!e.target.closest('.modal-content')) {
                    e.preventDefault();
                }
            }, { passive: false });
            
            // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∫—Ä–æ–ª–ª–∞ –∫–ª–∞–≤–∏—à–∞–º–∏
            window.addEventListener('keydown', function(e) {
                if ([32, 33, 34, 35, 36, 37, 38, 39, 40].includes(e.keyCode)) {
                    if (!document.querySelector('.modal:not([style*="display: none"])')) {
                        e.preventDefault();
                    }
                }
            });
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
            if (window.Telegram?.WebApp) {
                const tg = Telegram.WebApp;
                tg.expand();
                tg.enableClosingConfirmation();
                
                // –ü–æ–ª—É—á–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const user = tg.initDataUnsafe?.user;
                if (user?.first_name) {
                    document.getElementById('userName').textContent = 
                        `${user.first_name} –∏ –ú—ã—à—å–∫–∞`;
                }
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É "–ì–ª–∞–≤–Ω–∞—è"
            document.querySelectorAll('.nav-btn')[0].classList.add('active');
            
            // –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
            startStatusUpdates();
        });
        
        // ========== –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–¢–ê–¢–£–°–û–ú –ú–´–®–ö–ò ==========
        class BatStatus {
            constructor() {
                this.hunger = 60;
                this.happiness = 80;
                this.energy = 70;
                this.health = 100;
                this.coins = 100;
                this.level = 1;
                this.loadFromStorage();
            }
            
            saveToStorage() {
                localStorage.setItem('batStatus', JSON.stringify({
                    hunger: this.hunger,
                    happiness: this.happiness,
                    energy: this.energy,
                    health: this.health,
                    coins: this.coins,
                    level: this.level,
                    lastUpdate: Date.now()
                }));
            }
            
            loadFromStorage() {
                const saved = localStorage.getItem('batStatus');
                if (saved) {
                    const data = JSON.parse(saved);
                    Object.assign(this, data);
                    
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Ä–µ–º—è
                    if (data.lastUpdate) {
                        const hoursPassed = (Date.now() - data.lastUpdate) / (1000 * 60 * 60);
                        this.degradeOverTime(hoursPassed);
                    }
                }
                this.updateUI();
            }
            
            degradeOverTime(hours) {
                // –°–æ –≤—Ä–µ–º–µ–Ω–µ–º —Å—Ç–∞—Ç—É—Å—ã —É—Ö—É–¥—à–∞—é—Ç—Å—è
                this.hunger = Math.min(100, this.hunger + hours * 5);
                this.happiness = Math.max(0, this.happiness - hours * 3);
                this.energy = Math.max(0, this.energy - hours * 2);
                
                if (this.hunger > 90) {
                    this.health = Math.max(0, this.health - hours * 10);
                }
            }
            
            feed() {
                if (this.hunger > 0) {
                    this.hunger = Math.max(0, this.hunger - 20);
                    this.happiness = Math.min(100, this.happiness + 10);
                    this.updateUI();
                    this.saveToStorage();
                    return true;
                }
                return false;
            }
            
            play() {
                if (this.energy > 20) {
                    this.happiness = Math.min(100, this.happiness + 15);
                    this.energy = Math.max(0, this.energy - 10);
                    this.hunger = Math.min(100, this.hunger + 5);
                    this.updateUI();
                    this.saveToStorage();
                    return true;
                }
                return false;
            }
            
            clean() {
                this.happiness = Math.min(100, this.happiness + 5);
                this.updateUI();
                this.saveToStorage();
            }
            
            sleep() {
                this.energy = 100;
                this.updateUI();
                this.saveToStorage();
            }
            
            updateUI() {
                document.querySelector('.hunger').style.width = `${this.hunger}%`;
                document.querySelector('.happiness').style.width = `${this.happiness}%`;
                document.querySelector('.energy').style.width = `${this.energy}%`;
                
                document.getElementById('hungerValue').textContent = `${Math.round(this.hunger)}%`;
                document.getElementById('happinessValue').textContent = `${Math.round(this.happiness)}%`;
                document.getElementById('energyValue').textContent = `${Math.round(this.energy)}%`;
                
                document.getElementById('coins').textContent = this.coins;
                document.getElementById('level').textContent = this.level;
                document.getElementById('health').textContent = Math.round(this.health);
            }
        }
        
        // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –º—ã—à–∫–∏
        const bat = new BatStatus();
        
        // ========== –§–£–ù–ö–¶–ò–ò –î–ï–ô–°–¢–í–ò–ô ==========
        function performAction(action) {
            const batChar = document.querySelector('.bat-character');
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –¥–µ–π—Å—Ç–≤–∏—è
            batChar.style.animation = 'none';
            setTimeout(() => {
                batChar.style.animation = 'batHover 2s ease-in-out infinite';
            }, 100);
            
            switch(action) {
                case 'feed':
                    if (bat.feed()) {
                        showNotification('–ú—ã—à—å–∫–∞ –ø–æ–µ–ª–∞! ü©∏');
                        animateAction('feed');
                    } else {
                        showNotification('–ú—ã—à—å–∫–∞ –Ω–µ –≥–æ–ª–æ–¥–Ω–∞!');
                    }
                    break;
                case 'play':
                    if (bat.play()) {
                        showNotification('–ú—ã—à—å–∫–∞ –ø–æ–∏–≥—Ä–∞–ª–∞! üëª');
                        animateAction('play');
                    } else {
                        showNotification('–ú—ã—à—å–∫–∞ —É—Å—Ç–∞–ª–∞!');
                    }
                    break;
                case 'clean':
                    bat.clean();
                    showNotification('–ú—ã—à—å–∫–∞ –ø–æ–º—ã—Ç–∞! ‚ú®');
                    animateAction('clean');
                    break;
                case 'sleep':
                    bat.sleep();
                    showNotification('–ú—ã—à—å–∫–∞ —Å–ø–∏—Ç... üí§');
                    animateAction('sleep');
                    break;
            }
        }
        
        function animateAction(action) {
            const effects = {
                feed: { emoji: 'ü©∏', color: '#ff0000' },
                play: { emoji: 'üëª', color: '#8b00ff' },
                clean: { emoji: '‚ú®', color: '#00ccff' },
                sleep: { emoji: 'üí§', color: '#66ccff' }
            };
            
            const effect = document.createElement('div');
            effect.textContent = effects[action].emoji;
            effect.style.cssText = `
                position: fixed;
                font-size: 30px;
                animation: floatUp 1s ease-out forwards;
                z-index: 1000;
                pointer-events: none;
                color: ${effects[action].color};
                left: ${Math.random() * 70 + 15}%;
                top: 40%;
            `;
            
            document.body.appendChild(effect);
            setTimeout(() => effect.remove(), 1000);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª—å –∞–Ω–∏–º–∞—Ü–∏–∏ –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
            if (!document.getElementById('floatAnimation')) {
                const style = document.createElement('style');
                style.id = 'floatAnimation';
                style.textContent = `
                    @keyframes floatUp {
                        0% { opacity: 1; transform: translateY(0) scale(1); }
                        100% { opacity: 0; transform: translateY(-50px) scale(0.5); }
                    }
                `;
                document.head.appendChild(style);
            }
        }
        
        // ========== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–ê–ù–ï–õ–¨–Æ –ù–ê–í–ò–ì–ê–¶–ò–ò ==========
        function openTab(tabName) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –Ω–∞–∂–∞—Ç–æ–π –∫–Ω–æ–ø–∫–µ
            event.target.closest('.nav-btn').classList.add('active');
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
            closeAllModals();
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –º–æ–¥–∞–ª–∫—É
            if (tabName !== 'home') {
                document.getElementById(tabName + 'Modal').style.display = 'block';
            }
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É "–ì–ª–∞–≤–Ω–∞—è"
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('.nav-btn')[0].classList.add('active');
        }
        
        function closeAllModals() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });
        }
        
        // ========== –ü–û–ö–£–ü–ö–ò –í –ú–ê–ì–ê–ó–ò–ù–ï ==========
        function buyItem(item) {
            const prices = { blood: 25, crown: 100, cloak: 75 };
            
            if (bat.coins >= prices[item]) {
                bat.coins -= prices[item];
                bat.saveToStorage();
                bat.updateUI();
                showNotification('–ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞! üéÅ');
            } else {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
            }
        }
        
        // ========== –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–¢–ê–¢–£–°–ê ==========
        function startStatusUpdates() {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
            setInterval(() => {
                // –ù–µ–º–Ω–æ–≥–æ —É—Ö—É–¥—à–∞–µ–º —Å—Ç–∞—Ç—É—Å—ã
                bat.hunger = Math.min(100, bat.hunger + 0.5);
                bat.happiness = Math.max(0, bat.happiness - 0.3);
                bat.energy = Math.max(0, bat.energy - 0.2);
                
                if (bat.hunger > 90) {
                    bat.health = Math.max(0, bat.health - 1);
                }
                
                bat.updateUI();
                bat.saveToStorage();
            }, 60000); // 1 –º–∏–Ω—É—Ç–∞
            
            // –ú–µ–Ω—è–µ–º –≤–∏–¥ –≤ –æ–∫–Ω–µ
            updateWindowView();
            setInterval(updateWindowView, 600000); // 10 –º–∏–Ω—É—Ç
        }
        
        function updateWindowView() {
            const now = new Date();
            const hour = now.getHours();
            const windowContent = document.getElementById('windowContent');
            
            if (hour >= 6 && hour < 12) {
                windowContent.textContent = 'üåÖ –£—Ç—Ä–æ';
                windowContent.style.background = 'linear-gradient(to bottom, #ff7e5f, #feb47b)';
            } else if (hour >= 12 && hour < 18) {
                windowContent.textContent = '‚òÄÔ∏è –î–µ–Ω—å';
                windowContent.style.background = 'linear-gradient(to bottom, #87CEEB, #E0F6FF)';
            } else if (hour >= 18 && hour < 22) {
                windowContent.textContent = 'üåÜ –í–µ—á–µ—Ä';
                windowContent.style.background = 'linear-gradient(to bottom, #654ea3, #da98b4)';
            } else {
                windowContent.textContent = 'üåô –ù–æ—á—å';
                windowContent.style.background = 'linear-gradient(to bottom, #0f0c29, #302b63)';
            }
        }
        
        // ========== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ==========
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(139, 0, 255, 0.9);
                color: white;
                padding: 12px 24px;
                border-radius: 20px;
                z-index: 3000;
                animation: slideDown 0.3s ease-out;
                backdrop-filter: blur(10px);
                border: 2px solid #ff0066;
                white-space: nowrap;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideUp 0.3s ease-out forwards';
                setTimeout(() => notification.remove(), 300);
            }, 2000);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
            if (!document.getElementById('notificationAnimations')) {
                const style = document.createElement('style');
                style.id = 'notificationAnimations';
                style.textContent = `
                    @keyframes slideDown {
                        from { transform: translateX(-50%) translateY(-100px); opacity: 0; }
                        to { transform: translateX(-50%) translateY(0); opacity: 1; }
                    }
                    @keyframes slideUp {
                        from { transform: translateX(-50%) translateY(0); opacity: 1; }
                        to { transform: translateX(-50%) translateY(-100px); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
        }
        
        // ========== –ó–ê–ü–†–ï–¢ –ö–û–ù–¢–ï–ö–°–¢–ù–û–ì–û –ú–ï–ù–Æ ==========
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });
    </script>
</body>
</html>
